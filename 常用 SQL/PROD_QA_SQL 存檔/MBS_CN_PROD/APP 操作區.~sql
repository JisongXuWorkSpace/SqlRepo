### APP 操作區 ###
同仁反映：8/9 外出先施作 S210624047工單，再到下一地點執行下一單 R210719061，完成後再回頭到第一個點執行 S2106
24047工單，完成後直接回家，在家中約莫於18:30左右按下 <返回公司>，但 TBS內此段工時沒有寫進去。請參考附檔的時序圖。同仁家住：
台北市文山區興隆路四段105巷47號。(因檔案有2.1M，煩請告知e-mail，方便再寄過去) ， 謝謝

-- 2021/10/7 上午 08:41:45

-- 人員名稱
SELECT FE.EMP_NO||' '||FE.EMP_NAME FROM FIX_EMPDATA FE WHERE FE.EMP_NO='C03694'
-- 座標檔
SELECT * FROM Fix_App_Emp_Location AL WHERE AL.EMP_NO ='C03694' AND TRUNC(AL.APP_TIME) >= TO_DATE('211015','YYMMDD') AND AL.OPERATION_TYPE <> '09' ORDER BY AL.APP_TIME
-- 下載工單 XIAMT
SELECT * FROM EAI_TRANSMIT_MESSAGE_LOG EL WHERE EL.FUNC_CODE='XIAMT' AND EL.CREATE_EMP_NO ='C03694' AND TRUNC(EL.CREATE_TIME) >= TO_DATE('211015','YYMMDD') ORDER BY EL.CREATE_TIME 
-- 作業回傳 XIARW
SELECT * FROM EAI_TRANSMIT_MESSAGE_LOG EL WHERE EL.FUNC_CODE='XIARW' AND EL.CREATE_EMP_NO ='C03694' AND TRUNC(EL.CREATE_TIME) >= TO_DATE('211015','YYMMDD') ORDER BY EL.CREATE_TIME 
-- 當天登入狀況
2021/10/15 下午 10:01:42
SELECT * FROM FIX_PHONE_DATA PD WHERE UPPER(PD.ACCOUNT) = (SELECT NVL(UPPER(FE.LDAP_ID),'C03694') FROM FIX_EMPDATA FE WHERE FE.EMP_NO='C03694') AND TRUNC(PD.CREATE_DATE) >= TO_DATE('211015','YYMMDD') ORDER BY PD.CREATE_DATE;
-- 當天工時 
SELECT * FROM FIX_SERVICE FS WHERE FS.EMP_NO='C03694' AND FS.WORK_START_DATE >= TO_DATE('211015','YYMMDD') ORDER BY FS.WORK_START_DATE 
-- 座標
SELECT * FROM Fix_App_Emp_Location AL WHERE AL.Mt_Slip_No='S210929022' and AL.OPERATION_TYPE='08' AND AL.EMP_NO='C03694' ORDER BY AL.APP_TIME desc
-- 回程座標
SELECT * FROM Fix_App_Emp_Location AL WHERE  1= 1 and AL.OPERATION_TYPE='08' AND AL.EMP_NO='C03694' ORDER BY AL.APP_TIME desc

SELECT * FROM FIX_APP_WORK_RECORD WR WHERE WR.CREATE_EMP_NO = 'C03694' AND WR.CREATE_DATE >= TO_DATE('211015','YYMMDD') 
-- 
SELECT * FROM EAI_TRANSMIT_MESSAGE_LOG EL WHERE EL.FUNC_CODE='FXAP' AND EL.CREATE_EMP_NO ='C03694' AND TRUNC(EL.CREATE_TIME) >= TO_DATE('211015','YYMMDD') ORDER BY EL.CREATE_TIME 

-- 005
SELECT * FROM FIX_SETTING WHERE KEY ='SOLUTION'
SELECT * FROM FIX_SETTING WHERE KEY ='SOLUTION4'


-- 回車程起訖

SELECT * FROM Fix_App_Emp_Location AL where al.seq_no='5395522' and al.operation_type='08' and al.drive_cal_flag='C';
UPDATE TBS_MAJ.Fix_App_Emp_Location AL SET AL.DRIVE_CAL_FLAG='O' , AL.UPDATE_DATE = SYSDATE where al.seq_no='5395522' and al.operation_type='08' and al.drive_cal_flag='C';
--S201025014


-- 人員開始記錄重複
-- 2021/8/24 上午 07:11:29

SELECT * FROM Fix_App_Emp_Location AL WHERE 1=1 AND AL.WORK_START_TIME =  TO_DATE('211015 09:02:30','YYMMDD HH24:MI:SS') and AL.EMP_NO = 'C03694';

-- DCM

UPDATE TBS_MAJ.FIX_APP_EMP_LOCATION AL SET AL.WORK_START_TIME = TO_DATE('211015 09:02:31','YYMMDD HH24:MI:SS')  WHERE 1=1 AND AL.WORK_START_TIME =  TO_DATE('211015 09:02:30','YYMMDD HH24:MI:SS') and AL.EMP_NO = 'C03694';


-- 2021/10/11 上午 09:02:30
S211011097
-- 座標紀錄
SELECT * FROM FIX_APP_LOG ALOG WHERE ALOG.EMP_NO='C03694' AND ALOG.METHOD_NAME = 'addRecord' AND ALOG.REQUEST_LOG LIKE '%"operationType": "04"%' AND ALOG.CREATE_TIME >=  TO_DATE('211015','YYMMDD')  ORDER BY ALOG.CREATE_TIME  
-- 工單下載(含工時紀錄)
SELECT * FROM FIX_APP_LOG ALOG WHERE ALOG.EMP_NO='C03694' AND ALOG.METHOD_NAME = 'getSlipList' AND ALOG.CREATE_TIME >=  TO_DATE('211015','YYMMDD')  ORDER BY ALOG.CREATE_TIME  

-- APP 資料
SELECT AL.BU_CODE AS BU , AL.COMPANY_CODE AS 公司 , (SELECT FE.EMP_NO||' '||FE.EMP_NAME FROM FIX_EMPDATA FE WHERE FE.EMP_NO= AL.EMP_NO ) 人員 , AL.OPERATION_TYPE AS 類型 , AL.APP_TIME AS APP時間 , AL.APP_SERVER_TIME AS APP手機時間 , AL.WORK_START_TIME AS 工作開始 , AL.WORK_LINE_NO AS 項次,
AL.DRIVE_CAL_FLAG 車程 , AL.APP_WORK_TYPE AS 工作類型 , AL.MT_COMPANY_CODE AS 工單公司, AL.MT_SLIP_NO AS 工單單號 , AL.DUTY , AL.LOCATION AS 座標 , AL.LOCATION_TYPE AS 座標類型 , AL.LOCATION_REMARK AS 座標註記 , AL.SYSTEM_CLOSE_FLAG AS 系統註記   
, AL.WORK_START_DATE , AL.WORK_END_DATE , AL.START_TIME_HH , AL.START_TIME_MI , AL.END_TIME_HH , AL.END_TIME_MI , AL.EXTEND_WORK_FLAG AS 加班註記
FROM Fix_App_Emp_Location AL WHERE AL.EMP_NO ='C03694' AND TRUNC(AL.APP_TIME) >= TO_DATE('211015','YYMMDD') AND AL.OPERATION_TYPE IN('02','03','04','05','06','07','08','12','18') ORDER BY AL.APP_TIME



-- 人員
SELECT * FROM SCS_EMPDATA WHERE EMP_NO='C03694'
